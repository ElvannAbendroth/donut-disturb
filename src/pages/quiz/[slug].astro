---
import { getCollection } from 'astro:content'
import Layout from '@/layouts/Layout.astro'
import Prose from '@/components/Prose'
import Section from '@/components/Section'
import { getHeadings } from '@/utils/utils'
import HeroSection from '@/components/sections/HeroSection.astro'
import { Button } from '@/components/ui/button'

// Generate a new path for every collection entry
export async function getStaticPaths() {
  const donutEntries = await getCollection('donut')

  return donutEntries.map((entry, i) => {
    const publishedEntries = donutEntries

    const headings = getHeadings(entry.body)

    return {
      params: { slug: entry.slug },
      props: { entry, headings },
    }
  })
}

// Get the entry directly from the prop on render
const { entry, headings } = Astro.props
const { Content } = await entry.render()
export const prerender = true
---

<Layout title={entry.data.title} description={entry.data.snippet} openGraphImage={entry.data.image.src.src}>
  <!-- Hero -->
  <HeroSection title={entry.data.title} image={entry.data.image.src.src} />
  <Section.Root className="flex flex-col"
    ><Section.Content className="flex flex-col gap-6 max-w-layout items-center mx-auto w-full">
      <Prose><Content /></Prose>
    </Section.Content></Section.Root
  >
  <Section.Root className="flex flex-col"
    ><Section.Content className="flex flex-col gap-6 max-w-layout items-center mx-auto w-full">
      <div class="flex flex-col gap-6 flex-grow w-full">
        <a href="/quiz"><Button>Return</Button></a>
      </div>
    </Section.Content></Section.Root
  >
</Layout>
